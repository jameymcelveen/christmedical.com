#!/bin/bash
#
# Pre-commit hook to prevent direct commits to main branch
#

# Colors for output
RED='\033[0;31m'
YELLOW='\033[1;33m'
GREEN='\033[0;32m'
NC='\033[0m' # No Color

# Get the current branch name
BRANCH=$(git symbolic-ref --short HEAD 2>/dev/null)

# Check if we're on main branch
if [ "$BRANCH" = "main" ]; then
    echo -e "${RED}‚ùå ERROR: Direct commits to 'main' branch are not allowed!${NC}"
    echo ""
    echo -e "${YELLOW}Please use the following workflow:${NC}"
    echo "  1. Create a feature branch: ${GREEN}git checkout -b feature/your-feature-name${NC}"
    echo "  2. Make your changes on the feature branch"
    echo "  3. Commit your changes: ${GREEN}git commit -m 'Your commit message'${NC}"
    echo "  4. Push the feature branch: ${GREEN}git push origin feature/your-feature-name${NC}"
    echo "  5. Create a Pull Request to merge into main"
    echo ""
    echo -e "${YELLOW}If you've already committed by mistake:${NC}"
    echo "  1. Undo the last commit (keeps changes): ${GREEN}git reset --soft HEAD~1${NC}"
    echo "  2. Or undo the last commit (discards changes): ${GREEN}git reset --hard HEAD~1${NC}"
    echo "  3. Create a feature branch: ${GREEN}git checkout -b feature/your-feature-name${NC}"
    echo "  4. Commit again on the feature branch"
    echo ""
    exit 1
fi

exit 0
